{"version":3,"sources":["../../../../src/api/resources/usuario/usuario.service.js"],"names":["encryptPassword","plainText","salt","bcrypt","genSaltSync","hashSync","comparePassword","encryptedPassword","compareSync","validateSignup","body","schema","Joi","object","keys","nombre","string","required","apellido","email","password","role","number","integer","validate","value","error","details","validateLogin"],"mappings":";;;;;;AAAA;;;;AACA;;;;;;kBAEe;AAEXA,mBAFW,2BAEKC,SAFL,EAEgB;AACvB,YAAMC,OAAOC,mBAAOC,WAAP,CAAmB,EAAnB,CAAb;AACA,eAAOD,mBAAOE,QAAP,CAAgBJ,SAAhB,EAA2BC,IAA3B,CAAP;AACH,KALU;AAOXI,mBAPW,2BAOKL,SAPL,EAOgBM,iBAPhB,EAOmC;AAC1C,eAAOJ,mBAAOK,WAAP,CAAmBP,SAAnB,EAA8BM,iBAA9B,CAAP;AACH,KATU;AAWXE,kBAXW,0BAWIC,IAXJ,EAWU;;AAEjB,YAAMC,SAASC,cAAIC,MAAJ,GAAaC,IAAb,CAAkB;AAC7BC,oBAAQH,cAAII,MAAJ,GAAaC,QAAb,EADqB;AAE7BC,sBAAUN,cAAII,MAAJ,GAAaC,QAAb,EAFmB;AAG7BE,mBAAOP,cAAII,MAAJ,GAAaC,QAAb,GAAwBE,KAAxB,EAHsB;AAI7BC,sBAAUR,cAAII,MAAJ,GAAaC,QAAb,EAJmB;AAK7BI,kBAAMT,cAAIU,MAAJ,GAAaC,OAAb;AALuB,SAAlB,CAAf;;AAFiB,4BAUQX,cAAIY,QAAJ,CAAad,IAAb,EAAmBC,MAAnB,CAVR;AAAA,YAUTc,KAVS,iBAUTA,KAVS;AAAA,YAUFC,KAVE,iBAUFA,KAVE;;AAYjB,YAAIA,SAASA,MAAMC,OAAnB,EAA4B;AACxB,mBAAO,EAAED,YAAF,EAAP;AACH;AACD,eAAO,EAAED,YAAF,EAAP;AACH,KA3BU;AA6BXG,iBA7BW,yBA6BGlB,IA7BH,EA6BS;;AAEhB,YAAMC,SAASC,cAAIC,MAAJ,GAAaC,IAAb,CAAkB;AAC7BK,mBAAOP,cAAII,MAAJ,GAAaC,QAAb,GAAwBE,KAAxB,EADsB;AAE7BC,sBAAUR,cAAII,MAAJ,GAAaC,QAAb;AAFmB,SAAlB,CAAf;;AAFgB,6BAOSL,cAAIY,QAAJ,CAAad,IAAb,EAAmBC,MAAnB,CAPT;AAAA,YAORc,KAPQ,kBAORA,KAPQ;AAAA,YAODC,KAPC,kBAODA,KAPC;;AAShB,YAAIA,SAASA,MAAMC,OAAnB,EAA4B;AACxB,mBAAO,EAAED,YAAF,EAAP;AACH;AACD,eAAO,EAAED,YAAF,EAAP;AACH;AA1CU,C","file":"usuario.service.js","sourcesContent":["import Joi from 'joi';\r\nimport bcrypt from 'bcryptjs';\r\n\r\nexport default {\r\n\r\n    encryptPassword(plainText) {\r\n        const salt = bcrypt.genSaltSync(10);\r\n        return bcrypt.hashSync(plainText, salt);\r\n    },\r\n\r\n    comparePassword(plainText, encryptedPassword) {\r\n        return bcrypt.compareSync(plainText, encryptedPassword);\r\n    },\r\n\r\n    validateSignup(body) {\r\n\r\n        const schema = Joi.object().keys({\r\n            nombre: Joi.string().required(),\r\n            apellido: Joi.string().required(),\r\n            email: Joi.string().required().email(),\r\n            password: Joi.string().required(),\r\n            role: Joi.number().integer(),\r\n        });\r\n\r\n        const { value, error } = Joi.validate(body, schema);\r\n\r\n        if (error && error.details) {\r\n            return { error };\r\n        }\r\n        return { value };\r\n    },\r\n\r\n    validateLogin(body) {\r\n\r\n        const schema = Joi.object().keys({\r\n            email: Joi.string().required().email(),\r\n            password: Joi.string().required()\r\n        });\r\n\r\n        const { value, error } = Joi.validate(body, schema);\r\n\r\n        if (error && error.details) {\r\n            return { error };\r\n        }\r\n        return { value };\r\n    }\r\n\r\n};"]}